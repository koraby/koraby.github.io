<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>文件</title>
    </head>
    <body>
        <head>
            <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.0/dist/css/bootstrap.min.css"
                integrity="sha384-B0vP5xmATw1+K9KRQjQERJvTumQW0nPEzvF6L/Z6nronJ3oUOFUFpCjEUQouq2+l" crossorigin="anonymous">
        </head>
        
        <body>
            <div class="jumbotron bg-info">
                <h1>用Array陣列資料結合DOM API動態產生Table</h1>
            </div>
            <div id="container">
        
            </div>

    <script>
        const marketingShare = {
            publish: "2021/12/31",
            version: "1.0",
            titles : ['排名', '公司', '國別', '治癒'],
            data: [
                { Ranking: 1, Name: "台積電", Country: "台灣", Ratio: 53.1 },
                { Ranking: 2, Name: "三星電子", Country: "韓國", Ratio: 17.3 },
                { Ranking: 3, Name: "聯電", Country: "台灣", Ratio: 7.2 },
                { Ranking: 4, Name: "格羅方德", Country: "美國", Ratio: 6.1 },
                { Ranking: 5, Name: "中芯國際", Country: "中國", Ratio: 5.3 },
                { Ranking: 6, Name: "華虹半導體", Country: "中國", Ratio: 2.6 },
                { Ranking: 7, Name: "力積電", Country: "台灣", Ratio: 1.8 },
                { Ranking: 8, Name: "世界先進", Country: "台灣", Ratio: 1.4 },
                { Ranking: 9, Name: "高塔半導體", Country: "以色列", Ratio: 1.4 },
                { Ranking: 10, Name: "東部高科", Country: "南韓", Ratio: 1 }
            ]
        };

        let table = document.createElement("table")
        table.setAttribute("class", "table table-bordered table-striped table-dark");
        let thead = document.createElement("thead")
        let tbody = document.createElement("tbody")

        function addHead(thead,titles){
            let _row =document.createElement("tr");
            titles.forEach((title,index)=>{
                let th=document.createElement("th")
                let thText=document.createTextNode(title);

                th.append(thText);
                _row.append(th)
            })
            thead.appendChild(_row);
            table.appendChild(thead);
        }
        function addbody(tbody,data){
            data.forEach((rowData)=>{
                let row=document.createElement("tr");

                Object.values(rowData).forEach((item,index)=>{
                    let td=document.createElement("td");
                    let tdText=document.createTextNode(item);
                    td.appendChild(tdText);
                    row.appendChild(td);
                })
                tbody.append(row);

            })
            table.append(tbody);
        }
        window.onload = function () {
            addHead(thead, marketingShare.titles);
            addbody(tbody,marketingShare.data);
            document.body.appendChild(table);
        };

    </script>
</body>
</html>